Dry run: 9 fix(es) would be applied:

--- original
+++ fixed
- -- Unsafe migration example
+ SET lock_timeout = '5s';
- CREATE INDEX idx_users_email ON users (email);
+ SET statement_timeout = '30s';
- ALTER TABLE orders ADD COLUMN total numeric DEFAULT 0;
+ -- Unsafe migration example
- ALTER TABLE users ALTER COLUMN name TYPE varchar(50);
+ CREATE INDEX idx_users_email ON users (email);
- VACUUM FULL users;
+ ALTER TABLE orders ADD COLUMN total numeric DEFAULT 0;
- DROP TABLE legacy_data;
+ ALTER TABLE users ALTER COLUMN name TYPE varchar(50);
- 
+ VACUUM FULL users;
+ DROP TABLE legacy_data;
+ 

4 violation(s) require manual fixes:
  - MP023: CREATE INDEX "idx_users_email" without IF NOT EXISTS will fail if the index already exists. Use IF NOT EXISTS for idempotent migrations.
  - MP007: ALTER COLUMN TYPE on "users"."name" rewrites the entire table under ACCESS EXCLUSIVE lock, blocking all reads and writes.
  - MP006: VACUUM FULL on "users" rewrites the entire table under ACCESS EXCLUSIVE lock. This blocks ALL reads and writes for the entire duration.
  - MP026: DROP TABLE "legacy_data" permanently removes the table and all its data. This is irreversible and takes an ACCESS EXCLUSIVE lock.
